<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
  <title>ບັນທຶກລາຍຮັບ-ລາຍຈ່າຍ</title>

  <link rel="icon" href="https://cdn-icons-png.flaticon.com/128/1001/1001068.png">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet"/>
  <style>

    @import url('https://fonts.googleapis.com/css2?family=Phetsarath:wght@400;700&display=swap');

    :root {
      --bg-dark: #121212;
      --bg-light: #1e1e1e;
      --primary: #7209b7;
      --primary-light: #9d4edd;
      --secondary: #4cc9f0;
      --text: #f8f9fa;
      --danger: #e63946;
      --success: #38b000;
      --warning: #ffb703;
      --shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "Phetsarath", sans-serif;
    }

    body {
      background: var(--bg-dark);
      color: var(--text);
      font-family: 'Kanit', sans-serif;
      background-image: url('https://www.transparenttextures.com/patterns/dark-grunge.png'), linear-gradient(135deg, #1a1a2e, #16213e);
      min-height: 100vh;
      line-height: 1.6;
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
      padding: 15px;
    }

    header {
      text-align: center;
      margin-bottom: 25px;
      color: var(--primary-light);
    }

    header h1 {
      font-size: 1.8rem;
      margin-bottom: 8px;
    }

    header p {
      font-size: 0.95rem;
      opacity: 0.8;
    }

    .login-container, .app-container {
      background: rgba(30, 30, 30, 0.9);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 25px;
      box-shadow: var(--shadow);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .login-container {
      max-width: 400px;
      margin: 10vh auto;
    }

    .form-group {
      margin-bottom: 16px;
      position: relative;
    }

    label {
      display: block;
      margin-bottom: 6px;
      color: var(--primary-light);
      font-size: 0.95rem;
    }

    input, select, button {
      width: 100%;
      padding: 12px 14px;
      border-radius: 10px;
      border: 1px solid #444;
      background: #2a2a2a;
      color: var(--text);
      font-size: 1rem;
    }

    input:focus, select:focus {
      outline: none;
      border-color: var(--primary-light);
      box-shadow: 0 0 0 2px rgba(157, 78, 221, 0.3);
    }

    /* กล่องใส่รหัสผ่าน + ปุ่มตา */
    .password-container {
      position: relative;
    }

    #password {
      padding-right: 45px;
    }

    .toggle-password {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: #aaa;
      cursor: pointer;
      font-size: 1.2rem;
      transition: color 0.3s;
    }

    .toggle-password:hover {
      color: var(--primary-light);
    }

    button {
      background: linear-gradient(90deg, var(--primary), var(--primary-light));
      color: white;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      border: none;
      margin-top: 10px;
      font-size: 1rem;
      padding: 14px;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 18px rgba(114, 9, 183, 0.5);
    }

    button:active {
      transform: translateY(0);
    }

    .logout-btn {
      background: var(--danger);
      margin-top: 20px;
      padding: 14px;
      font-size: 1.1rem;
      border-radius: 12px;
    }

    .logout-btn:hover {
      background: #c1121f;
    }

    .hidden {
      display: none !important;
    }

    .form-container {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      margin-bottom: 25px;
    }

    .form-container > div {
      flex: 1 1 120px;
    }

    .calendar-controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 20px 0;
      padding: 12px 16px;
      background: rgba(40, 40, 40, 0.6);
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .calendar-controls h2 {
      color: var(--secondary);
      font-size: 1.3rem;
      margin: 0;
    }

    .btn-nav {
      background: var(--bg-light);
      color: var(--primary-light);
      width: 44px;
      height: 44px;
      border: none;
      border-radius: 50%;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s;
    }

    .btn-nav:hover {
      background: var(--primary);
      transform: scale(1.1);
    }

    /* สรุปยอด */
    .summary {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 12px;
      margin: 20px 0;
    }

    .summary-box {
      background: rgba(40, 40, 40, 0.7);
      padding: 16px;
      border-radius: 12px;
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .summary-box h3 {
      font-size: 0.9rem;
      opacity: 0.9;
      margin-bottom: 6px;
    }

    .summary-box .amount {
      font-size: 1.3rem;
      font-weight: 600;
    }

    .income-text {
      color: var(--success);
    }

    .expense-text {
      color: var(--danger);
    }

    .balance-text {
      color: var(--warning);
    }

    /* ตาราง */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
      background: rgba(30, 30, 30, 0.6);
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    th, td {
      padding: 14px 16px;
      text-align: left;
      border-bottom: 1px solid #333;
    }

    th {
      background: var(--primary);
      color: white;
      font-weight: 500;
    }

    tr:hover {
      background: #2a2a2a;
    }

    .action-btn {
      background: none;
      border: none;
      color: var(--danger);
      cursor: pointer;
      font-size: 1.3rem;
      padding: 6px;;
    }

    .action-btn:hover i {
      transform: scale(1.3);
    }

    .income {
      color: var(--success);
      font-weight: 600;
    }

    .expense {
      color: var(--danger);
    }

    /* มือถือ */
    @media (max-width: 768px) {
      .container {
        padding: 12px;
      }

      header h1 {
        font-size: 1.6rem;
      }

      .form-container {
        flex-direction: column;
      }

      .calendar-controls h2 {
        font-size: 1.1rem;
      }

      .btn-nav {
        width: 40px;
        height: 40px;
        font-size: 1.1rem;
      }

      .summary {
        grid-template-columns: 1fr;
        gap: 10px;
      }

      .summary-box {
        padding: 14px;
      }

      .summary-box h3 {
        font-size: 0.95rem;
      }

      .summary-box .amount {
        font-size: 1.2rem;
      }

      table, thead, tbody, th, td, tr {
        display: block;
      }

      th {
        position: absolute;
        top: -9999px;
        left: -9999px;
      }

      tr {
        margin-bottom: 16px;
        border: 1px solid #333;
        border-radius: 12px;
        padding: 12px;
        background: #1e1e1e;
      }

      td {
        position: relative;
        padding: 10px 14px 10px 50%;
        border: none;
      }

      td:before {
        content: attr(data-label);
        position: absolute;
        left: 15px;
        top: 10px;
        width: 45%;
        font-weight: 600;
        color: var(--primary-light);
        font-size: 0.95rem;
      }

      .mobile-actions {
        display: none;
        font-size: 14px;
}

@media (max-width: 768px) {
  /* ... ส่วนอื่นๆ เดิม ... */

  .desktop-actions {
    display: none;
  }

  .mobile-actions {
    display: contents;
    text-align: center;
    padding: 12px 0;
    border-top: 1px dashed #444;
  }

  /* ปรับให้ td ไม่ทับกัน */
  td {
    padding: 10px 14px 10px 50% !important;
  }

  /* ถ้าต้องการให้ mobile-actions ไม่ทับกับก่อนหน้า */
  tr {
    position: relative;
  }
}

      .desktop-actions {
        display: none;
      }

      .logout-btn {
        font-size: 1.15rem;
        padding: 16px;
        margin-top: 25px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- ໜ້າເຂົ້າສູ່ລະບົບ -->
<div id="loginPage" class="login-container">
  <h2 style="color: var(--primary-light);"><i class="fas fa-lock"></i> ເຂົ້າສູ່ລະບົບ</h2>
  
  <div class="form-group">
    <label for="username">ຊື່ຜູ້ໃຊ້</label>
    <input type="text" id="username" placeholder="ປ້ອນຊື່ຜູ້ໃຊ້" />
  </div>

  <div class="form-group">
    <label for="password">ລະຫັດຜ່ານ</label>
    <div style="position: relative;">
      <input type="password" id="password" placeholder="ປ້ອນລະຫັດຜ່ານ" />
      <span id="togglePassword" style="
        position: absolute;
        right: 14px;
        top: 50%;
        transform: translateY(-50%);
        cursor: pointer;
        color: #9d4edd;
        font-size: 1.2rem;
        user-select: none;
        z-index: 10;
      ">
        <i class="fas fa-eye"></i>
      </span>
    </div>
  </div>

  <button id="loginBtn"><i class="fas fa-sign-in-alt"></i> ເຂົ້າສູ່ລະບົບ</button>
</div>

    <!-- ລະບົບຫຼັກ -->
    <div id="app" class="app-container hidden">
      <header>
        <h1><i class="fas fa-wallet"></i> ລາຍຮັບ-ລາຍຈ່າຍ</h1>
        <p>ຈັດການການເງິນຂອງທ່ານຢ່າງມືອາຊີບ</p>
      </header>

      <!-- ຕົວເລືອກເດືອນ -->
      <div class="calendar-controls">
        <button id="prevMonth" class="btn-nav"><i class="fas fa-chevron-left"></i></button>
        <h2 id="currentMonth">ກໍລະກົດ 2024</h2>
        <button id="nextMonth" class="btn-nav"><i class="fas fa-chevron-right"></i></button>
      </div>

      <!-- ຟອມບັນທຶກ -->
      <div class="form-container">
        <div>
          <label for="type">ປະເພດ</label>
          <select id="type">
            <option value="income">ລາຍຮັບ</option>
            <option value="expense">ລາຍຈ່າຍ</option>
          </select>
        </div>
        <div>
          <label for="amount">ຈຳນວນເງິນ</label>
          <input type="number" id="amount" placeholder="0.00" step="0.01" />
        </div>
        <div>
          <label for="date">ວັນທີ</label>
          <input type="date" id="date" />
        </div>
        <div>
          <label for="detail">ລາຍລະອຽດ</label>
          <input type="text" id="detail" placeholder="ເຊັ່ນ: ຄ່າເຊົ່າ, ເງິນເນັດ" />
        </div>
        <div style="display: flex; align-items: flex-end;">
          <button id="addBtn"><i class="fas fa-plus"></i> ເພີ່ມ</button>
        </div>
      </div>

      <!-- ລວມຍອດ -->
      <div class="summary">
        <div class="summary-box">
          <h3>ລວມລາຍຮັບ</h3>
          <div id="totalIncome" class="amount income-text">0.00</div>
        </div>
        <div class="summary-box">
          <h3>ລວມລາຍຮັບ</h3>
          <div id="totalExpense" class="amount expense-text">0.00</div>
        </div>
        <div class="summary-box">
          <h3>ລວມລາຍຮັບ</h3>
          <div id="balance" class="amount balance-text">0.00</div>
        </div>
      </div>

      <!-- ຕາຕະລາງ -->
      <table>
        <thead>
          <tr>
            <th>ວັນທີ<</th>
            <th>ລາຍລະອຽດ</th>
            <th>ປະເພດ</th>
            <th>ຈຳນວນ</th>
            <th class="desktop-actions">ການກະທຳ</th>
          </tr>
        </thead>
        <tbody id="transactionList"></tbody>
      </table>

      <!-- ປຸ່ມອອກ -->
      <button id="logoutBtn" class="logout-btn">
        <i class="fas fa-sign-out-alt"></i> ອອກຈາກລະບົບ
      </button>
    </div>
  </div>

  <script>
    const laoMonths = [
      'ມັງກອນ', 'ກຸມພາ', 'ມີນາ', 'ເມສາ',
      'ພຶດສາພາ', 'ມີຖຸນາ', 'ກໍລະກົົດ', 'ສິງຫາ',
      'ກັນຍາ', 'ຕຸລາ', 'ພະຈິກ', 'ທັນວາ'
    ];

    const today = new Date();
    let currentMonth = today.getMonth();
    let currentYear = today.getFullYear();
    let transactions = JSON.parse(localStorage.getItem('transactions')) || [];

    // ຈັດຮູບເງິນ
    function formatNumber(num) {
      return parseFloat(num || 0).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    // ອັບເດດເດືອນ
    function updateMonthDisplay() {
  document.getElementById('currentMonth').textContent = `${laoMonths[currentMonth]} ${currentYear}`;
  renderTransactions();
}

    function renderTransactions() {
      const list = document.getElementById('transactionList');
      list.innerHTML = '';

      const filtered = transactions.filter(t => {
        const date = new Date(t.date);
        return date.getMonth() === currentMonth && date.getFullYear() === currentYear;
      });

      let totalIncome = 0;
      let totalExpense = 0;

      filtered.forEach((t, index) => {
        const date = new Date(t.date);
  
  // ສະແດງລາຍການ
  const day = date.getDate(); // ເຊັ່ນ 15
  const month = laoMonths[date.getMonth()]; // ກໍລະກົດ
  const year = date.getFullYear(); // 2024

  const formattedDate = `${day} ${month} ${year}`;

  const row = document.createElement('tr');
  row.innerHTML = `
    <td data-label="ວັນທີ">${formattedDate}</td>
    <td data-label="ລາຍລະອຽດ">${t.detail || '-'}</td>
    <td data-label="ປະເພດ"><span class="${t.type}">${t.type === 'income' ? 'ລາຍຮັບ' : 'ລາຍຈ່າຍ'}</span></td>
    <td data-label="ຈຳນວນເງິນ" class="${t.type}">${formatNumber(t.amount)}</td>
    <td class="desktop-actions">
      <button class="action-btn" onclick="deleteTransaction(${index})"><i class="fas fa-trash"></i></button>
    </td>
        `;
        
        // ເພິ່ມປ່ມລົບໃນໂທລະສັບ
    const mobileActions = document.createElement('td');
    mobileActions.classList.add('mobile-actions');
    mobileActions.setAttribute('colspan', '5');
    mobileActions.style = 'text-align: center; padding: 10px; border-top: 1px dashed #444;';
    mobileActions.innerHTML = `
      <button class="action-btn" style="font-size: 1.3rem;" onclick="deleteTransaction(${index})">
        <i class="fas fa-trash"></i> 
      </button>
    `;
    
    row.appendChild(mobileActions);
    list.appendChild(row);

    if (t.type === 'income') {
      totalIncome += parseFloat(t.amount);
    } else {
      totalExpense += parseFloat(t.amount);
    }
  });

  const balance = totalIncome - totalExpense;

  document.getElementById('totalIncome').textContent = formatNumber(totalIncome);
  document.getElementById('totalExpense').textContent = formatNumber(totalExpense);
  document.getElementById('balance').textContent = formatNumber(balance);
}

    // ເພີ່ມລາຍການ
    document.getElementById('addBtn').addEventListener('click', () => {
      const type = document.getElementById('type').value;
      const amount = document.getElementById('amount').value;
      const date = document.getElementById('date').value;
      const detail = document.getElementById('detail').value; // ເກັບເປັນ ISO string (ຄ.ສ.)

      if (!amount || !date) {
        alert('ກະລຸນາປ້ອນຈຳນວນເງິນ ແລະ ວັນທີ');
        return;
      }

      transactions.push({ type, amount, date, detail });
      localStorage.setItem('transactions', JSON.stringify(transactions));
      document.getElementById('amount').value = '';
      document.getElementById('detail').value = '';
      renderTransactions();
    });

    // ລຶບລາຍການ
    window.deleteTransaction = function(index) {
      if (confirm('ທ່ານແນ່ໃຈບໍ່ທີ່ຈະລຶບລາຍການນີ້?')) {
        transactions.splice(index, 1);
        localStorage.setItem('transactions', JSON.stringify(transactions));
        renderTransactions();
      }
    };

    document.getElementById('prevMonth').addEventListener('click', () => {
      currentMonth--;
      if (currentMonth < 0) {
        currentMonth = 11;
        currentYear--;
      }
      updateMonthDisplay();
    });

    document.getElementById('nextMonth').addEventListener('click', () => {
      currentMonth++;
      if (currentMonth > 11) {
        currentMonth = 0;
        currentYear++;
      }
      updateMonthDisplay();
    });

    // ດູລະຫັດຜ່ານ
document.getElementById('togglePassword').addEventListener('click', function () {
  const passwordInput = document.getElementById('password');
  const icon = this.querySelector('i');

  if (passwordInput.type === 'password') {
    passwordInput.type = 'text';
    icon.classList.replace('fa-eye', 'fa-eye-slash');
  } else {
    passwordInput.type = 'password';
    icon.classList.replace('fa-eye-slash', 'fa-eye');
  }
});

    // ລະບົບລັອກອິນ
    document.getElementById('loginBtn').addEventListener('click', () => {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;

      if (username && password) {
        localStorage.setItem('isLoggedIn', 'true');
        document.getElementById('loginPage').classList.add('hidden');
        document.getElementById('app').classList.remove('hidden');
        document.getElementById('date').valueAsDate = today;
        updateMonthDisplay();
      } else {
        alert('กรุณากรอกข้อมูลให้ครบ');
      }
    });

    // ອອກຈາກລະບົບ
    document.getElementById('logoutBtn').addEventListener('click', () => {
      if (confirm('ທ່ານແນ່ໃຈບໍ່ທີ່ຈະອອກຈາກລະບົບ?')) {
        localStorage.removeItem('isLoggedIn');
        document.getElementById('app').classList.add('hidden');
        document.getElementById('loginPage').classList.remove('hidden');
        document.getElementById('username').value = '';
        document.getElementById('password').value = '';
      }
    });

    // ກວດສອບການເຂົ້າສູ່ລະບົບ
    window.onload = () => {
      const isLoggedIn = localStorage.getItem('isLoggedIn');
      if (isLoggedIn) {
        document.getElementById('loginPage').classList.add('hidden');
        document.getElementById('app').classList.remove('hidden');
        document.getElementById('date').valueAsDate = today;
        updateMonthDisplay();
      } else {
        document.getElementById('app').classList.add('hidden');
      }
    };
  </script>
</body>
</html>